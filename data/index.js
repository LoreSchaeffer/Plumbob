function onSettingsReceived(e){$("#brightness").val(e.brightness),$("#mode").val(e.mode).trigger("change"),$("#ledSwitch").attr("checked",1===e.led_enabled),$("#frSpeed").val(e.full_rainbow_speed),$("#arSpeed").val(e.animated_rainbow_speed),$("#rscColor").val(hueToHex(e.random_static_color)),$("#rscSpeed").val(e.random_static_color_speed),$("#apSpeed").val(e.animated_palette_speed),$("#ftbSpeed").val(e.fade_to_black_speed),$("#ftbfSpeed").val(e.fade_to_black_fade_speed),$("#bRgbBPM").val(e.bpm_color),$("#bRgbSpeed").val(e.fade_color_speed),$("#bRgbColor").val(rgbToHex(e.b_rgb_color)),$("#fSpeed").val(e.fire_speed),$("#fCooling").val(e.fire_cooling),$("#fSparks").val(e.fire_sparks),$("#sRgbColor").val(rgbToHex(e.s_rgb_color))}function resetSettings(){$(".settings").addClass("hidden")}function modeChange(e){postData("/settings",JSON.stringify(e))}function toRGB(e){const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}function toHSV(e){const a=toRGB(e);let o=a[0],n=a[1],t=a[2];o/=255,n/=255,t/=255;let d,s=Math.max(o,n,t),r=Math.min(o,n,t),l=(s+r)/2,i=(s+r)/2;if(s===r)l=d=0;else{let e=s-r;switch(d=i>.5?e/(2-s-r):e/(s+r),s){case o:l=(n-t)/e+(n<t?6:0);break;case n:l=(t-o)/e+2;break;case t:l=(o-n)/e+4}l/=6}return[l,d,i]}function hueToHex(e){s=1,l=.5;let a=(1-Math.abs(2*l-1))*s,o=a*(1-Math.abs(e/60%2-1)),n=l-a/2,t=0,d=0,r=0;return 0<=e&&e<60?(t=a,d=o,r=0):60<=e&&e<120?(t=o,d=a,r=0):120<=e&&e<180?(t=0,d=a,r=o):180<=e&&e<240?(t=0,d=o,r=a):240<=e&&e<300?(t=o,d=0,r=a):300<=e&&e<360&&(t=a,d=0,r=o),t=Math.round(255*(t+n)),d=Math.round(255*(d+n)),r=Math.round(255*(r+n)),t=t.toString(16),d=d.toString(16),r=r.toString(16),1===t.length&&(t="0"+t),1===d.length&&(d="0"+d),1===r.length&&(r="0"+r),"#"+t+d+r}function rgbToHex(e){return e=e.split(","),r=parseInt(e[0]).toString(16),g=parseInt(e[1]).toString(16),b=parseInt(e[2]).toString(16),1===r.length&&(r="0"+r),1===g.length&&(g="0"+g),1===b.length&&(b="0"+b),"#"+r+g+b}$(window).on("load",()=>{$.get("/get_settings").done(function(e){onSettingsReceived(e)})}),$("#submitBtn").click(()=>{postData("/save","{}"),event.preventDefault()}),$("#ledSwitch").click(function(){postData("/enable",JSON.stringify({enabled:$(this).is(":checked")}))}),$("#brightness").change(function(){postData("/brightness",JSON.stringify({brightness:$(this).val()}))}),$("#mode").change(function(){const e=parseInt($(this).val());switch(resetSettings(),e){case 0:modeChange({mode:e});break;case 1:modeChange({mode:e}),$("#fullRainbow").removeClass("hidden");break;case 2:modeChange({mode:e}),$("#animatedRainbow").removeClass("hidden");break;case 3:modeChange({mode:e}),$("#randomSingleColor").removeClass("hidden");break;case 4:modeChange({mode:e});break;case 5:modeChange({mode:e}),$("#animatedPalette").removeClass("hidden");break;case 6:modeChange({mode:e}),$("#fadeToBlackByPalette").removeClass("hidden");break;case 7:modeChange({mode:e}),$("#beatRGB").removeClass("hidden");break;case 8:modeChange({mode:e});break;case 9:modeChange({mode:e}),$("#fire").removeClass("hidden");break;case 10:modeChange({mode:e}),$("#staticRGB").removeClass("hidden")}}),$("#frSpeed").change(function(){modeChange({mode:parseInt($("#mode").val()),speed:$(this).val()})}),$("#arSpeed").change(function(){modeChange({mode:parseInt($("#mode").val()),speed:$(this).val()})}),$(document).on("change","#rscColor, #rscSpeed",function(){modeChange({mode:parseInt($("#mode").val()),color:255*toHSV($("#rscColor").val())[0],speed:$("#rscSpeed").val()})}),$("#apSpeed").change(function(){modeChange({mode:parseInt($("#mode").val()),speed:$(this).val()})}),$(document).on("change","#ftbSpeed, #ftbfSpeed",function(){modeChange({mode:parseInt($("#mode").val()),speed:$("#ftbSpeed").val(),fade:$("#ftbfSpeed").val()})}),$(document).on("change","#bRgbColor, #bRgbBPM, #bRgbSpeed",function(){let e=toRGB($("#bRgbColor").val());modeChange({mode:parseInt($("#mode").val()),bpm:$("#bRgbBPM").val(),fade:$("#bRgbSpeed").val(),red:e[0],green:e[1],blue:e[2]})}),$(document).on("change","#fSpeed, #fCooling, #fSparks",function(){modeChange({mode:parseInt($("#mode").val()),speed:$("#fSpeed").val(),cooling:$("#fCooling").val(),sparks:$("#fSparks").val()})}),$("#sRgbColor").change(function(){let e=toRGB($("#sRgbColor").val());modeChange({mode:parseInt($("#mode").val()),red:e[0],green:e[1],blue:e[2]})});